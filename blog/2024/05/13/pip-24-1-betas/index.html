<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>pip 24.1 betas -- help us test a major upcoming change! | Pradyun Gedam</title>
<meta name=keywords content="Python Packaging,pip"><meta name=description content="The pip team has released pip 24.1b1 which contains a lot of significant improvements and bug fixes.
I&rsquo;d like to highlight a major change in this blog post: the removal of support for &ldquo;legacy&rdquo; versions and dependency specification, or as I like to call it, nonsensical versions and dependencies. We&rsquo;re releasing this as a beta to get feedback from the community on how this change affects their workflows.
Nonsensical versions and dependencies For a bunch of historical reasons, pip has allowed many arbitrary strings as versions and dependency specification."><meta name=author content><link rel=canonical href=https://pradyunsg.me/blog/2024/05/13/pip-24-1-betas/><link crossorigin=anonymous href=/assets/css/stylesheet.187c2d5911ee36d5bc65695fd777b1318dd7927b49b8ce1f7384b8a0cad6a95e.css integrity="sha256-GHwtWRHuNtW8ZWlf13exMY3XkntJuM4fc4S4oMrWqV4=" rel="preload stylesheet" as=style><link rel=icon href=https://pradyunsg.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://pradyunsg.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://pradyunsg.me/favicon-32x32.png><link rel=apple-touch-icon href=https://pradyunsg.me/apple-touch-icon.png><link rel=mask-icon href=https://pradyunsg.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="pip 24.1 betas -- help us test a major upcoming change!"><meta property="og:description" content="The pip team has released pip 24.1b1 which contains a lot of significant improvements and bug fixes.
I&rsquo;d like to highlight a major change in this blog post: the removal of support for &ldquo;legacy&rdquo; versions and dependency specification, or as I like to call it, nonsensical versions and dependencies. We&rsquo;re releasing this as a beta to get feedback from the community on how this change affects their workflows.
Nonsensical versions and dependencies For a bunch of historical reasons, pip has allowed many arbitrary strings as versions and dependency specification."><meta property="og:type" content="article"><meta property="og:url" content="https://pradyunsg.me/blog/2024/05/13/pip-24-1-betas/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2024-05-13T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="pip 24.1 betas -- help us test a major upcoming change!"><meta name=twitter:description content="The pip team has released pip 24.1b1 which contains a lot of significant improvements and bug fixes.
I&rsquo;d like to highlight a major change in this blog post: the removal of support for &ldquo;legacy&rdquo; versions and dependency specification, or as I like to call it, nonsensical versions and dependencies. We&rsquo;re releasing this as a beta to get feedback from the community on how this change affects their workflows.
Nonsensical versions and dependencies For a bunch of historical reasons, pip has allowed many arbitrary strings as versions and dependency specification."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Scribbled Notes","item":"https://pradyunsg.me/blog/"},{"@type":"ListItem","position":2,"name":"pip 24.1 betas -- help us test a major upcoming change!","item":"https://pradyunsg.me/blog/2024/05/13/pip-24-1-betas/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"pip 24.1 betas -- help us test a major upcoming change!","name":"pip 24.1 betas -- help us test a major upcoming change!","description":"The pip team has released pip 24.1b1 which contains a lot of significant improvements and bug fixes.\nI\u0026rsquo;d like to highlight a major change in this blog post: the removal of support for \u0026ldquo;legacy\u0026rdquo; versions and dependency specification, or as I like to call it, nonsensical versions and dependencies. We\u0026rsquo;re releasing this as a beta to get feedback from the community on how this change affects their workflows.\nNonsensical versions and dependencies For a bunch of historical reasons, pip has allowed many arbitrary strings as versions and dependency specification.","keywords":["Python Packaging","pip"],"articleBody":"The pip team has released pip 24.1b1 which contains a lot of significant improvements and bug fixes.\nI’d like to highlight a major change in this blog post: the removal of support for “legacy” versions and dependency specification, or as I like to call it, nonsensical versions and dependencies. We’re releasing this as a beta to get feedback from the community on how this change affects their workflows.\nNonsensical versions and dependencies For a bunch of historical reasons, pip has allowed many arbitrary strings as versions and dependency specification. There’s so many kinds of bad behaviours that this “feature” has enabled.\nMy favourite example is one I wrote back in 2022 on the packaging1 project’s issue tracker:\n\u003e\u003e\u003e packaging.version.parse(\"This is a completely random string\") \u003cLegacyVersion('This is a completely random string')\u003e Or providing weird version comparisons:\n\u003e\u003e\u003e packaging.version.parse(\"1.0\") \u003e packaging.version.parse(\"99999.0.whatever\") True \u003e\u003e\u003e packaging.version.parse(\"1.0\") \u003cVersion('1.0')\u003e \u003e\u003e\u003e packaging.version.parse(\"99999.0.whatever\") \u003cLegacyVersion('99999.0.whatever')\u003e Or hiding mistakes in dependency declarations:\n\u003e\u003e\u003e all_dependencies = [ ... \"package == 1\" ... \"another-package\", ... \"yet-another-package\", ] \u003e\u003e\u003e [packaging.requirements.Requirement(s) for s in all_dependencies] [\u003cRequirement('package==1another-package')\u003e, \u003cRequirement('yet-another-package')\u003e] Over a decade ago, the Python packaging ecosystem adopted PEP 440 which defined a standard for versions and dependency specification. While this standard has been adopted by basically every single tool in the ecosystem, support for “legacy” versions and requirements has been maintained even though it has caused a lot of user confusion and bugs in the Python ecosystem.\nGetting rid of the nonsense Over the course of the last decade, across multiple projects in the Python packaging ecosystem, many PyPA projects have been working to make this behaviour not possible. The package index, https://pypi.org, has not accepted uploads with bad versions for many years now and is also enforcing validity of the requirements on all uploads. The tooling that generate packages (build-backends) also now refuse to generate packages with such bad metadata in them.\nThis effort has been undertaken by many people across the Python packaging ecosystem, and I’m very grateful for all the work that has gone into this. It regularly surprises me how much work goes into making sure that the foundational pieces of Python’s packaging ecosystem are improving, even absent any institutional investment into it.\nThis pip release marks the next major step in the direction of improving behaviours in this area: updating the package installer to stop accepting such packages. Starting with this pip release, pip will refuse to install packages with bad versions or dependency specification and will ignore any files with such bad versions or dependency specification during the dependency resolution step.\nWhere we can’t see the nonsense While a substantial amount of effort has been put into making sure pip can work correctly when enforcing correctness around these versions and dependency specification, we want to be cautious in rolling out this change. There are many places that Python is used where we can’t access the packages (e.g. private package indexes hosting proprietary code), and thus can’t ensure that packages have appropriate metadata in those spaces.\nWe’re releasing this as a beta to get feedback from the community on any issues that might arise from this change. This will help us better understand how this change affects user workflows and what actionable guidance can be provided to users in various contexts.\nHelp us test the changes We’re looking for feedback from Python users on this beta release. Notably, we’d like for users who are using package indexes other than PyPI to test their workflows against this beta release of pip and provide us with feedback.\nYou can let us know about issues related to this change on pip’s issue tracker (please check for duplicates before filing, and use reactions rather than saying “me too”!). Please also feel welcome to tell us about the good stuff, like if this release made dependency resolves quicker – we like hearing about that too! :)\nAcknowledgements While there’s a lot of people who have worked on things I mentioned in this blog post, I can’t really list them all here – you know who you are, and thank you for all the work you’ve done toward this as well as the other cool things you’ve worked on.\nI do want to thank Paul Moore, Stéphane Bidoul, Richard Si and Pavithra Eswaramoorthy for reviewing various drafts of this post and providing feedback on it.\nListen, software engineers are great at naming things. This is obviously the Python package providing shared common implementations of Python packaging standards for Python packaging tools. And, yes, it’s hosted on the Python package index. ↩︎\n","wordCount":"754","inLanguage":"en","datePublished":"2024-05-13T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://pradyunsg.me/blog/2024/05/13/pip-24-1-betas/"},"publisher":{"@type":"Organization","name":"Pradyun Gedam","logo":{"@type":"ImageObject","url":"https://pradyunsg.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pradyunsg.me/ accesskey=h title="Pradyun Gedam (Alt + H)">Pradyun Gedam</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pradyunsg.me/about/ title=about><span>about</span></a></li><li><a href=https://pradyunsg.me/blog/ title=Blog><span>blog</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">pip 24.1 betas -- help us test a major upcoming change!</h1><div class=post-meta>May 13, 2024&nbsp;·&nbsp;4 minutes</div></header><div class=post-content><p>The pip team has released <a href=https://pypi.org/project/pip/24.1b1/>pip 24.1b1</a> which contains a <a href=https://pip.pypa.io/en/latest/news/#b1-2024-05-06>lot of significant improvements and bug fixes</a>.</p><p>I&rsquo;d like to highlight a major change in this blog post: the removal of support for &ldquo;legacy&rdquo; versions and dependency specification, or as I like to call it, nonsensical versions and dependencies. We&rsquo;re releasing this as a beta to get feedback from the community on how this change affects their workflows.</p><h2 id=nonsensical-versions-and-dependencies>Nonsensical versions and dependencies<a hidden class=anchor aria-hidden=true href=#nonsensical-versions-and-dependencies>#</a></h2><p>For a bunch of historical reasons, pip has allowed many arbitrary strings as versions and dependency specification. There&rsquo;s so many kinds of bad behaviours that this &ldquo;feature&rdquo; has enabled.</p><p>My favourite example is <a href=https://github.com/pypa/packaging/issues/530>one I wrote back in 2022</a> on the <code>packaging</code><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> project&rsquo;s issue tracker:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> packaging<span style=color:#f92672>.</span>version<span style=color:#f92672>.</span>parse(<span style=color:#e6db74>&#34;This is a completely random string&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>LegacyVersion(<span style=color:#e6db74>&#39;This is a completely random string&#39;</span>)<span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>Or providing weird version comparisons:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> packaging<span style=color:#f92672>.</span>version<span style=color:#f92672>.</span>parse(<span style=color:#e6db74>&#34;1.0&#34;</span>) <span style=color:#f92672>&gt;</span> packaging<span style=color:#f92672>.</span>version<span style=color:#f92672>.</span>parse(<span style=color:#e6db74>&#34;99999.0.whatever&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> packaging<span style=color:#f92672>.</span>version<span style=color:#f92672>.</span>parse(<span style=color:#e6db74>&#34;1.0&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>Version(<span style=color:#e6db74>&#39;1.0&#39;</span>)<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> packaging<span style=color:#f92672>.</span>version<span style=color:#f92672>.</span>parse(<span style=color:#e6db74>&#34;99999.0.whatever&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>LegacyVersion(<span style=color:#e6db74>&#39;99999.0.whatever&#39;</span>)<span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>Or hiding mistakes in dependency declarations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> all_dependencies <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     <span style=color:#e6db74>&#34;package == 1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     <span style=color:#e6db74>&#34;another-package&#34;</span>,
</span></span><span style=display:flex><span><span style=color:#f92672>...</span>     <span style=color:#e6db74>&#34;yet-another-package&#34;</span>,
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> [packaging<span style=color:#f92672>.</span>requirements<span style=color:#f92672>.</span>Requirement(s) <span style=color:#66d9ef>for</span> s <span style=color:#f92672>in</span> all_dependencies]
</span></span><span style=display:flex><span>[<span style=color:#f92672>&lt;</span>Requirement(<span style=color:#e6db74>&#39;package==1another-package&#39;</span>)<span style=color:#f92672>&gt;</span>, <span style=color:#f92672>&lt;</span>Requirement(<span style=color:#e6db74>&#39;yet-another-package&#39;</span>)<span style=color:#f92672>&gt;</span>]
</span></span></code></pre></div><p>Over a decade ago, the Python packaging ecosystem adopted <a href=https://peps.python.org/pep-0440/>PEP 440</a> which defined a standard for versions and dependency specification. While this standard has been adopted by basically every single tool in the ecosystem, support for &ldquo;legacy&rdquo; versions and requirements has been maintained even though it has caused a lot of user confusion and bugs in the Python ecosystem.</p><h2 id=getting-rid-of-the-nonsense>Getting rid of the nonsense<a hidden class=anchor aria-hidden=true href=#getting-rid-of-the-nonsense>#</a></h2><p>Over the course of the last decade, across multiple projects in the Python packaging ecosystem, many PyPA projects have been working to make this behaviour not possible. The package index, <a href=https://pypi.org>https://pypi.org</a>, has not accepted uploads with bad versions for many years now and is also enforcing validity of the requirements on all uploads. The tooling that generate packages (build-backends) also now refuse to generate packages with such bad metadata in them.</p><p>This effort has been undertaken by many people across the Python packaging ecosystem, and I&rsquo;m very grateful for all the work that has gone into this. It regularly surprises me how much work goes into making sure that the foundational pieces of Python&rsquo;s packaging ecosystem are improving, even absent any institutional investment into it.</p><p>This pip release marks the next major step in the direction of improving behaviours in this area: updating the package installer to stop accepting such packages. Starting with this pip release, pip will refuse to install packages with bad versions or dependency specification and will ignore any files with such bad versions or dependency specification during the dependency resolution step.</p><h2 id=where-we-cant-see-the-nonsense>Where we can&rsquo;t see the nonsense<a hidden class=anchor aria-hidden=true href=#where-we-cant-see-the-nonsense>#</a></h2><p>While a substantial amount of effort has been put into making sure pip can work correctly when enforcing correctness around these versions and dependency specification, we want to be cautious in rolling out this change. There are many places that Python is used where we can&rsquo;t access the packages (e.g. private package indexes hosting proprietary code), and thus can&rsquo;t ensure that packages have appropriate metadata in those spaces.</p><p>We&rsquo;re releasing this as a beta to get feedback from the community on any issues that might arise from this change. This will help us better understand how this change affects user workflows and what actionable guidance can be provided to users in various contexts.</p><h2 id=help-us-test-the-changes>Help us test the changes<a hidden class=anchor aria-hidden=true href=#help-us-test-the-changes>#</a></h2><p>We&rsquo;re looking for feedback from Python users on this beta release. Notably, we&rsquo;d like for users who are using package indexes other than PyPI to test their workflows against this beta release of pip and provide us with feedback.</p><p>You can let us know about issues related to this change on pip&rsquo;s issue tracker (please check for duplicates before filing, and use reactions rather than saying &ldquo;me too&rdquo;!). Please also feel welcome to tell us about the good stuff, like if this release made dependency resolves quicker &ndash; we like hearing about that too! :)</p><h2 id=acknowledgements>Acknowledgements<a hidden class=anchor aria-hidden=true href=#acknowledgements>#</a></h2><p>While there&rsquo;s a lot of people who have worked on things I mentioned in this blog post, I can&rsquo;t really list them all here &ndash; you know who you are, and thank you for all the work you&rsquo;ve done toward this as well as the other cool things you&rsquo;ve worked on.</p><p>I do want to thank Paul Moore, Stéphane Bidoul, Richard Si and Pavithra Eswaramoorthy for reviewing various drafts of this post and providing feedback on it.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Listen, software engineers are great at naming things. This is obviously the Python package providing shared common implementations of Python packaging standards for Python packaging tools. And, yes, it&rsquo;s hosted on the Python package index.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://pradyunsg.me/tags/python-packaging/>Python packaging</a></li><li><a href=https://pradyunsg.me/tags/pip/>pip</a></li></ul><nav class=paginav><a class=prev href=https://pradyunsg.me/blog/2024/05/31/python-scripts-with-pipx-bash/><span class=title>« Newer</span><br><span>Improving my dotfiles manager with pipx and inline dependency metadata</span>
</a><a class=next href=https://pradyunsg.me/blog/2024/03/17/github-notifications-userstyles/><span class=title>Older »</span><br><span>Making GitHub Notifications UI slightly nicer for bulk triage</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://pradyunsg.me/>Pradyun Gedam</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
with tweaks.</span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>